Learn how to get meaningful information from a fast Fourier transform (FFT). There is a lot of confusion on how to scale an FFT in a way that provides an understanding of the properties of the time-domain signal, which is addressed in this tech talk. Specifically, it covers how to go from an FFT to amplitude, power, and power density and why you may choose one representation over another—and the scenarios in which they are valid.

https://youtu.be/pfjiwxhqd1M?si=-rXt9jdstkhkA_wM视频链接

【【中英字幕】了解功率谱密度和功率谱 | Understanding Power Spectral Density and the Power Spectrum.】 https://www.bilibili.com/video/BV1ikAoeHEff/?share_source=copy_web&vd_source=bd31e19725768798743e111f9a0083bd

1
0:0:0,0 --> 0:0:1,7
在本视频中，我们将探讨

2
0:0:1,7 --> 0:0:7,5
如何**从快速傅里叶变换（FFT）中获取有意义的信息**。

3
0:0:7,52 --> 0:0:9,11
我想澄清一下，关于如何

4
0:0:9,11 --> 0:0:12,29
缩放FFT以理解时域信号特性的问题，

5
0:0:12,2 --> 0:0:16,6
我看到很多人对此感到困惑。

6
0:0:16,67 --> 0:0:18,38
具体来说，我想介绍如何

7
0:0:18,3 --> 0:0:26,8
从FFT转换到幅度、功率以及功率谱密度。

8
0:0:26,87 --> 0:0:28,82
我还想讨论为什么我们可能会选择

9
0:0:28,8 --> 0:0:33,0
这种表示方式而不是另一种，以及它们在哪些场景下是有效的。

10
0:0:33,2 --> 0:0:34,52
我认为这会很有用，

11
0:0:34,52 --> 0:0:36,42
所以我希望你能继续观看。

12
0:0:36,42 --> 0:0:40,89
我是Brian，欢迎来到MATLAB技术讲座。

13
0:0:40,89 --> 0:0:42,63
如果你不知道FFT是什么，

14
0:0:42,6 --> 0:0:46,5
我建议你观看我下面链接的视频。

15
0:0:46,59 --> 0:0:49,38
但现在，你只需要知道的是，

16
0:0:49,38 --> 0:0:51,66
当你对信号进行FFT时，

17
0:0:51,66 --> 0:0:54,15
它会返回一个复数向量。

18
0:0:54,1 --> 0:1:0,3
在这里，我只是绘制了时间信号xₙ的FFT的实部和虚部。

19
0:1:0,3 --> 0:1:6,5
这些数字代表了xₙ中存在的频率的相位和幅度。

20
0:1:6,54 --> 0:1:9,51
在那个视频中，我们讨论了在某些情况下，

21
0:1:9,51 --> 0:1:11,23
我们并不关心相位，

22
0:1:11,2 --> 0:1:15,5
因此我们只需通过取FFT的绝对值来查看幅度。

23
0:1:15,51 --> 0:1:18,99
然后，当处理实时间信号时，

24
0:1:18,9 --> 0:1:24,5
FFT的幅度在正频率和负频率之间是重复的。

25
0:1:24,57 --> 0:1:27,1
由于信息完全相同，

26
0:1:27,1 --> 0:1:30,33
我们可以选择只查看正频率，

27
0:1:30,33 --> 0:1:32,73
即所谓的单边FFT。

28
0:1:32,7 --> 0:1:40,7
这就是我们在那个视频中结束的地方，绘制了幅度与频率的单边图。

29
0:1:40,78 --> 0:1:43,45
现在，我们如何利用这些信息

30
0:1:43,45 --> 0:1:46,12
来理解时域信号的某些特性呢？

**31**
**0:1:46,12 --> 0:1:48,34**
**在进行频谱分析时，**

**32**
**0:1:48,34 --> 0:1:51,79**
**你必须从这个问题开始：为什么要进行频谱分析？**

**33**
**0:1:51,7 --> 0:1:56,7**
**你希望通过在频域中分析信号学到什么？**

**34**
**0:1:56,77 --> 0:1:58,84**
**这个问题之所以重要，**

**35**
**0:1:58,8 --> 0:2:3,4**
**是因为你使用的频谱分析工具取决于你的目标。**

36
0:2:3,4 --> 0:2:9,1
在本视频中，如何操作FFT也取决于你的目标。

37
0:2:9,16 --> 0:2:11,23
例如，如果你只想知道

38
0:2:11,2 --> 0:2:15,6
信号中频率成分的相对位置，

39
0:2:15,67 --> 0:2:18,25
那么这个幅度图就足够了。

40
0:2:18,2 --> 0:2:23,5
我的意思是，我可以看出在110赫兹处有一个强频率成分，

41
0:2:23,56 --> 0:2:27,52
而在100赫兹处有一个较弱但仍然明显的成分。

42
0:2:27,52 --> 0:2:29,71
这种分析水平可能

43
0:2:29,71 --> 0:2:34,27
足以判断信号中是否存在60赫兹的噪声，

44
0:2:34,2 --> 0:2:38,9
或者某个振动结构的固有频率是多少。

45
0:2:38,9 --> 0:2:43,5
所以，你能从幅度中获取这些信息是很酷的。

46
**0:2:43,54 --> 0:2:48,31**
**但这个图的缺点是，y轴上的值**

**47**
**0:2:48,3 --> 0:2:52,7**
**并不是与时域信号的某些物理特性相关的量。**![image-20251108204141926](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108204141926.png)

48
0:2:52,7 --> 0:2:56,6
那么，如果你确实想知道**信号的某些定量信息**呢？

### 得到某个特定频率的正弦波的幅度

49
0:2:56,6 --> 0:3:1,3
比如你想知道**某个特定频率下正弦波的幅度。**

50
0:3:1,33 --> 0:3:3,4
好吧，我先剧透一下，

51
0:3:3,4 --> 0:3:4,57
这就是你该怎么做：![image-20251108204302751](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108204302751.png)

52
0:3:4,57 --> 0:3:7,21
取FFT的绝对值，

53
0:3:7,2 --> 0:3:12,7
然后除以N，即信号中的总样本数。

54
0:3:12,74 --> 0:3:14,86
这会产生幅度，但它

55
0:3:14,8 --> 0:3:20,8
被分成了两部分，一半的幅度在正频率中，另一半在负频率中。

56
0:3:20,89 --> 0:3:23,77
因此，如果我们只想查看单边频谱，

57
0:3:23,77 --> 0:3:26,41
我们可以忽略负频率，

58
0:3:26,41 --> 0:3:29,17
并将每个正频率的值加倍，

59
0:3:29,1 --> 0:3:35,6
**除了直流项（0赫兹）和奈奎斯特频率。**

60
0:3:35,69 --> 0:3:38,45
我们可以转到MATLAB中看看这是如何工作的。

61
0:3:38,45 --> 0:3:41,66
它实际上返回了正弦波的幅度。

62
0:3:41,6 --> 0:3:45,7
我有一个包含两个正弦波的时间信号，幅度分别为1和4。

63
0:3:45,77 --> 0:3:48,59
然后我取FFT的绝对值，

64
0:3:48,5 --> 0:3:55,5
除以样本数，然后只查看单边并加倍，除了DC和奈奎斯特频率。

65
0:3:55,5 --> 0:4:3,5
当我绘制这个频谱时，y轴现在显示的幅度是1和4，非常完美。

66
0:4:3,56 --> 0:4:7,61
但问题可能是，**为什么我们要除以N？**

67
0:4:7,61 --> 0:4:9,92
我的意思是，为什么这能起作用呢？

68
0:4:9,92 --> 0:4:13,91
让我们快速解释一下。

69
0:4:13,9 --> 0:4:18,8
好的，FFT在数学上等同于离散傅里叶变换（DFT），

70
0:4:18,8 --> 0:4:21,56
这意味着我们从时域信号xₙ开始，

71
0:4:21,5 --> 0:4:28,1
将其乘以一个相关信号（即这里的指数函数），然后对所有样本求和。![image-20251108204629032](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108204629032.png)

72
0:4:28,13 --> 0:4:32,6
这将产生频域系数xₖ。

73
0:4:32,6 --> 0:4:38,5
此外，e的虚数次方只是余弦和正弦的函数。

74
0:4:38,5 --> 0:4:42,7
好了，现在假设时域信号只是一个幅度为A的正弦波。

75
0:4:42,7 --> 0:4:46,3
它的频率是多少并不重要，所以我在这里只放一个点。

76
0:4:46,38 --> 0:4:48,68
如果我们将其代入DFT，

77
0:4:48,6 --> 0:4:59,8
我们会得到xₖ等于幅度A乘以所有样本的正弦乘以余弦减去i乘以正弦平方的和。

78
0:4:59,87 --> 0:5:3,86
正弦乘以余弦会产生另一个正弦波，

79
0:5:3,86 --> 0:5:7,37
因此在一个周期内的求和为0，

80
0:5:7,37 --> 0:5:8,93
它们相互抵消。

81
0:5:8,93 --> 0:5:11,9
所以无论信号有多长，

82
0:5:11,9 --> 0:5:14,1
这个求和结果总是接近于0。

83
0:5:14,1 --> 0:5:16,2
因此，第一个分量

84
0:5:16,2 --> 0:5:18,96
对求和的贡献不大。

![image-20251108204745784](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108204745784.png)

85
0:5:18,96 --> 0:5:21,45
另一方面，正弦平方看起来像这样，

86
0:5:21,45 --> 0:5:24,78
像一个在0和1之间波动的正弦波。

87
0:5:24,78 --> 0:5:29,4
由于这是离散的，我们对其进行了n次采样。

88
0:5:29,0 --> 0:5:32,6
现在，样本越多，这个和就越大。

89
0:5:32,64 --> 0:5:35,52
然而，如果我们把所有样本相加，

90
0:5:35,52 --> 0:5:37,89
然后除以样本数，

91
0:5:37,8 --> 0:5:42,1
这将给出正弦平方函数的平均高度，对吧？

92
0:5:42,15 --> 0:5:45,9
我的意思是，如果你把10个数相加并除以10，

93
0:5:45,9 --> 0:5:46,86
你会得到平均值。

94
0:5:46,86 --> 0:5:52,21
正弦平方的平均值是1/2。![image-20251108204606427](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108204606427.png)

95
0:5:52,21 --> 0:5:54,34
因此，如果我们回到上面的方程，

96
0:5:54,34 --> 0:5:58,42
我们可以将xₖ除以N。

97
0:5:58,42 --> 0:6:0,31
第一个分量的求和仍然是0，

98
0:6:0,31 --> 0:6:3,1
但第二个分量的求和是1/2 i，

99
0:6:3,1 --> 0:6:6,82
因为它只是正弦平方的平均高度。

100
0:6:6,8 --> 0:6:12,1
现在我们取xₖ的绝对值，这给出了FFT的幅度，

101
0:6:12,13 --> 0:6:15,79
它等于幅度的一半。![image-20251108205156515](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108205156515.png)

102
0:6:15,79 --> 0:6:18,1
同样，这里之所以是一半，

103
0:6:18,1 --> 0:6:21,8
是因为幅度被分成了正频率和负频率两部分。

104
0:6:21,85 --> 0:6:24,37
但如果我们只查看单边FFT，

105
0:6:24,37 --> 0:6:27,64
那么我们将这个值乘以2，![image-20251108205218774](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108205218774.png)

106
0:6:27,64 --> 0:6:30,43
最终得到幅度。

107
0:6:30,43 --> 0:6:33,37
现在，我只想指出，如果我们的原始时域信号

108
0:6:33,37 --> 0:6:36,91
有相位偏移，这在数学上仍然成立。

109
0:6:36,91 --> 0:6:40,54
我只是用了一个0相位的正弦波来使其更容易理解。

110
0:6:40,54 --> 0:6:42,85
但总的来说，这很酷，

111
0:6:42,8 --> 0:6:49,1
**我们可以通过取FFT并缩放它来找到正弦波的幅度。**

112
0:6:49,178 --> 0:6:50,47
好了，这就是幅度。

### 得到某个特定频率的正弦波的功率

113
0:6:50,47 --> 0:6:52,13
但如果我们想知道

114
0:6:52,13 --> 0:6:53,81
某个特定频率的功率呢？

115
0:6:53,81 --> 0:6:55,82
**正弦波的平均功率**

116
0:6:55,82 --> 0:6:58,76
**就是其幅度的平方除以2。**

117
0:6:58,7 --> 0:7:5,1
既然我们知道FFT的绝对值除以N会给出幅度的一半，

118
0:7:5,12 --> 0:7:8,48
那么最简单的方法就是将该值平方。

119
0:7:8,48 --> 0:7:10,94
这就是双边功率谱，![image-20251108205701426](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108205701426.png)

120
0:7:10,9 --> 0:7:14,5
因为功率被分成了负频率和正频率两部分。

121
0:7:14,51 --> 0:7:18,47
因此，要得到单边功率谱，我们将其乘以2。

122
0:7:18,4 --> 0:7:24,9
这就是我们从FFT到单边功率谱的转换过程。![image-20251108205747287](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108205747287.png)

123
0:7:24,98 --> 0:7:27,8
让我们回到MATLAB，

124
0:7:27,8 --> 0:7:29,66
看看如何实现这一点。

125
0:7:29,66 --> 0:7:31,41
顺便说一下，这与之前的脚本相同。

126
0:7:31,41 --> 0:7:34,4
所以我们正在处理相同的双正弦波信号。

127
0:7:34,0 --> 0:7:38,2
我将向下滚动到幅度部分之后，进入功率部分。

128
0:7:38,21 --> 0:7:41,84
在这里，我取FFT的绝对值，

129
0:7:41,84 --> 0:7:45,11
然后平方并除以N的平方。

130
0:7:45,11 --> 0:7:47,6
然后为了得到单边功率谱，

131
0:7:47,6 --> 0:7:49,19
我们忽略负频率

132
0:7:49,19 --> 0:7:51,44
并将正频率加倍，

133
0:7:51,44 --> 0:7:54,53
再次除了DC和奈奎斯特频率。

134
0:7:54,53 --> 0:7:59,3
现在，绘图看起来像这样，功率分别为1/2和8，

135
0:7:59,3 --> 0:8:3,8
分别对应于幅度1和4。

136
0:8:3,86 --> 0:8:6,26
所以一切都很顺利。

137
0:8:6,26 --> 0:8:9,65
但通常，我们喜欢以分贝为单位查看功率。

138
0:8:9,6 --> 0:8:15,5
所以让我在这里快速使用Pow to dB函数，然后重新运行这个脚本。

139
0:8:15,53 --> 0:8:19,19
这是我创建的单边功率谱，

140
0:8:19,19 --> 0:8:22,46
它需要几行代码。

141
0:8:22,4 --> 0:8:27,9
但每次你想得到功率谱时，你可以手动输入所有这些代码。

142
0:8:27,9 --> 0:8:32,1
或者你可以使用periodogram函数得到完全相同的结果。

```matlab
periodogram(xn,rectwin(length(xn)),length(xn),fs , 'power')
```

143
0:8:32,15 --> 0:8:35,69
创建周期图有很多不同的方法，

144
0:8:35,69 --> 0:8:39,59
但在这里，我使用**矩形窗口**运行它（不是汉宁窗或者其他窗口），

145
0:8:39,59 --> 0:8:42,2
窗口长度等于整个信号的长度，

146
0:8:42,0 --> 0:8:47,6
然后设置它返回功率谱而不是功率密度。

147
0:8:47,6 --> 0:8:51,7
这些参数完全复制了我们上面编写的代码。

148
0:8:51,722 --> 0:8:53,93
你得相信我的话，

149
0:8:53,93 --> 0:8:57,26
这两个图是完全相同的。

150
0:8:57,26 --> 0:8:58,7
好了，对吧？

### 该单边幅度和单边功率计算公式的三个前提条件

![image-20251108211308169](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108211308169.png)

151
0:8:58,7 --> 0:9:5,1
我们得到了单边幅度，我们取FFT的绝对值乘以2并除以N。

152
0:9:5,1 --> 0:9:10,5
为了得到功率，我们取FFT的绝对值平方乘以2并除以N的平方。

153
0:9:10,52 --> 0:9:13,4
这很简单，对吧？

154
0:9:13,4 --> 0:9:14,87
嗯，某种程度上是的。

155
0:9:14,87 --> 0:9:16,61
我们必须非常小心，

156
0:9:16,6 --> 0:9:21,6
因为这些结果只有在三个非常重要的条件下才成立。![image-20251108210502111](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108210502111.png)

* 
  **一是我们使用的是矩形窗口，而不是其他窗口，比如Hamming窗或 Blackman窗。**
* **二是时域信号是平稳的。**
* **三是我们处理的时域信号产生的是离散频率功率谱，而不是连续频谱。**

160
0:9:39,6 --> 0:9:44,3
让我逐一解释这些条件为什么重要，以及为什么这些方程在这些条件下才成立。

#### 矩形窗口&什么是窗口

##### 窗口的定义

161
0:9:44,3 --> 0:9:48,29
我们从矩形窗口开始。

162
0:9:48,29 --> 0:9:50,81
当我们对时域信号进行FFT时，

163
0:9:50,81 --> 0:9:53,9
信号必须是有限的。

164
0:9:53,9 --> 0:9:55,623
有一个开始时间和结束时间。

165
0:9:55,623 --> 0:9:57,29
因此，我们实际上只看到了

166
0:9:57,29 --> 0:10:1,61
整个可能的无限信号的一小部分。

167
0:10:1,6 --> 0:10:6,4
从这个子集中，我们试图理解信号的特性。

168
0:10:6,44 --> 0:10:8,57
这个数据子集被称为窗口，

169
0:10:8,57 --> 0:10:10,25
因为我们只看到了一部分，

170
0:10:10,25 --> 0:10:13,13
其余部分被遮挡了。

171
0:10:13,13 --> 0:10:16,187
窗口可以很长，也可以很短，

172
0:10:16,187 --> 0:10:18,77
或者我们可以查看信号的不同部分。

173
0:10:18,77 --> 0:10:23,24
但无论如何，我们总是只看到一个子集。

##### 矩形窗口的定义

174
0:10:23,24 --> 0:10:26,54
现在，我画的是一个矩形窗口。

175
0:10:26,54 --> 0:10:30,2
这意味着窗口中的每个样本都没有被修改。

176
0:10:30,2 --> 0:10:33,54
也就是说，我们将**窗口内的所有内容乘以1**，

177
0:10:33,54 --> 0:10:37,4
**窗口外的所有内容乘以0。**![image-20251108211809999](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108211809999.png)

178
0:10:37,4 --> 0:10:38,54
这是有道理的，对吧？

##### 频谱泄露&解决方法

179
0:10:38,54 --> 0:10:41,12
我的意思是，如果你想找出信号的特性，

180
0:10:41,12 --> 0:10:44,21
为什么要改变信号呢？

181
0:10:44,21 --> 0:10:46,73
一个原因是频谱泄漏。

182
0:10:46,73 --> 0:10:48,83
频谱泄漏的一种情况是，

183
0:10:48,8 --> 0:10:54,2
当时域信号的周期不是窗口长度的整数倍时。

184
0:10:54,24 --> 0:10:56,25
在这些情况下，像这样截断一个周期![image-20251108211931737](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108211931737.png)

185
0:10:56,2 --> 0:11:1,6
会**将信号能量分散到相邻的频率区间中，**

186
0:11:1,6 --> 0:11:6,4
因为**我们之前讨论的求和由于没有完整的周期而无法完全抵消。**

187
0:11:6,42 --> 0:11:9,54
缓解这种情况的一种方法是**使用更长的时间序列**，

188
0:11:9,54 --> 0:11:12,36
因为剩余的周期

189
0:11:12,36 --> 0:11:14,73
会**在更长的时间跨度内被平均**。

190
0:11:14,7 --> 0:11:19,8
但如果这不可能，那么另一种方法是**对数据应用非矩形窗口**，

191
0:11:19,8 --> 0:11:27,5
比如**hamming窗，它会衰减边缘附近的信号，从而减少部分周期的影响**。![image-20251108212225600](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108212225600.png)

192
0:11:27,54 --> 0:11:30,42
这减少了频谱泄漏，

193
0:11:30,42 --> 0:11:33,45
但也带来了**分辨率降低的代价**。

194
0:11:33,4 --> 0:11:38,1
我不会在本视频中详细介绍不同的窗口，我只是想让你知道，

195
0:11:38,1 --> 0:11:42,1
你可能并不总是处理矩形窗口。

196
0:11:42,15 --> 0:11:44,91
正如你所料，如果你衰减

197
0:11:44,91 --> 0:11:47,4
边缘附近的信号，

198
0:11:47,4 --> 0:11:51,6
你当然会影响窗口内的平均幅度和平均功率。

199
0:11:51,6 --> 0:11:58,7
因此，我们推导出的幅度和功率方程仅对矩形窗口有效。

200
0:11:58,7 --> 0:12:3,3
有一些方法可以在查看功率时考虑窗口的影响，

201
0:12:3,34 --> 0:12:5,14
我不会在本视频中讨论这些方法。

202
0:12:5,14 --> 0:12:9,31
但如果我们回到MATLAB和periodogram函数，

203
0:12:9,31 --> 0:12:12,76
我们可以看到它确实处理了窗口的影响。

204
0:12:12,76 --> 0:12:15,43
因为hamming窗和矩形窗口

205
0:12:15,4 --> 0:12:22,4
都为我在这里显示的110赫兹频率产生了正确的功率。

#### 时间序列必须是平稳的

206
0:12:22,41 --> 0:12:24,24
好的，第二个要求是

207
0:12:24,24 --> 0:12:26,76
时间序列必须是平稳的。

208
0:12:26,76 --> 0:12:28,62
这意味着

209
0:12:28,62 --> 0:12:31,53
**从统计角度来看，信号不会随时间变化。**

210
0:12:31,5 --> 0:12:36,2
**无论你查看信号的哪个部分，其均值和方差都是相同的。**![image-20251108212559844](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108212559844.png)

211
0:12:36,21 --> 0:12:39,18
这里有一个理解为什么这是要求的方法。

212
0:12:39,1 --> 0:12:45,9
还记得我们在推导幅度时除以N是因为我们在寻找平均幅度吗？

213
0:12:45,9 --> 0:12:50,9
我们假设幅度在窗口内是相对恒定的，对吧？

214
0:12:50,97 --> 0:12:53,94
比如，以这个信号为例。

215
0:12:53,9 --> 0:12:58,3
它是一个单一频率，但功率在整个窗口内是变化的。![image-20251108212800503](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108212800503.png)

216
0:12:58,35 --> 0:13:1,11
如果我们计算这个频率的功率，

217
0:13:1,11 --> 0:13:3,54
它会给出**窗口内的平均值**。

218
0:13:3,5 --> 0:13:7,2
但**它不会提供任何关于功率变化的信息。**

219
0:13:7,26 --> 0:13:8,94
最糟糕的情况是，

220
0:13:8,94 --> 0:13:12,72
如果有一个**非常短时间的高功率事件**，![image-20251108212856665](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108212856665.png)

221
0:13:12,72 --> 0:13:15,39
它会在一个长窗口内被平均，

222
0:13:15,39 --> 0:13:20,11
可能导致它被噪声淹没。

223
0:13:20,11 --> 0:13:23,8
好了，我们知道我们需要一个矩形窗口，

224
0:13:23,8 --> 0:13:26,2
并且我们希望窗口内的信号是平稳的。

#### 信号是离散频谱

225
0:13:26,2 --> 0:13:28,15
现在，对于第三个要求，

226
0:13:28,15 --> 0:13:31,3
我们需要信号具有离散频谱。

227
0:13:31,3 --> 0:13:36,19
为什么需要这样做是非常重要的。

228
0:13:36,19 --> 0:13:39,7
为了解释原因，让我们回到MATLAB。

229
0:13:39,7 --> 0:13:42,61
在这里，我有一个包含两个正弦波的时域信号，

230
0:13:42,61 --> 0:13:45,49
一个在100赫兹，一个在110赫兹。

231
0:13:45,4 --> 0:13:50,1
然后我进行FFT并缩放它以得到功率谱。

232
0:13:50,1 --> 0:13:54,0
现在我在这里绘制的是两个正弦波的真实功率，

233
0:13:54,0 --> 0:13:55,92
即红色和黄色的柱状图。

234
0:13:55,9 --> 0:14:0,0
我还绘制了信号的功率谱，即蓝色曲线。![image-20251108213042628](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108213042628.png)

235
0:14:0,3 --> 0:14:2,82
注意蓝色曲线的峰值

236
0:14:2,8 --> 0:14:5,4
并不是完全尖锐的，而是稍微分散了一些。

237
0:14:5,4 --> 0:14:10,6
这是因为我们使用了有限窗口导致的频谱泄漏。

238
0:14:10,6 --> 0:14:15,3
但重要的是，功率谱的峰值在8处。

239
0:14:15,3 --> 0:14:21,0
因此，即使有这种分散，我们仍然可以准确测量这些频率下的功率。

240
0:14:21,0 --> 0:14:24,4
现在让我隐藏代码，以便我们可以专注于这个图。

241
0:14:24,4 --> 0:14:29,9
当我将第二个正弦波的频率移近第一个时，

242
0:14:29,9 --> 0:14:34,0
观察它们的频谱如何开始相互干扰。

![image-20251108213146890](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108213146890.png)

![image-20251108213208150](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108213208150.png)



![image-20251108213254185](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108213254185.png)

243
0:14:34,2 --> 0:14:38,79
当它们太接近时，它们会合并成一个单一的峰值。

244
0:14:38,7 --> 0:14:43,6
现在，y轴的值并没有准确报告该频率下的功率。

245
0:14:43,6 --> 0:14:49,1
事实上，我们无法对每个单独正弦波的功率做出太多说明。

246
0:14:49,1 --> 0:14:56,0
**报告的是两个频率的某种组合，它们太接近而无法分开。**

247
0:14:56,4 --> 0:14:58,8
这只是两个离散的正弦波。

248
0:14:58,8 --> 0:15:1,62
但想象一下宽带信号的情况，

249
0:15:1,62 --> 0:15:4,35
其频谱是连续的。

250
0:15:4,3 --> 0:15:9,7
在这个图中，我展示了100到100.5赫兹之间的50个正弦波。![image-20251108213339401](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108213339401.png)

251
0:15:9,75 --> 0:15:13,56
每个正弦波贡献了非常小的功率。

252
0:15:13,5 --> 0:15:19,9
但如果我缩小视图，我们可以看到时域信号的功率谱要高得多，![image-20251108213405401](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108213405401.png)

253
0:15:19,92 --> 0:15:22,59
因为**它们都对总功率贡献了一点点**。

254
0:15:22,5 --> 0:15:27,6
所以希望你能看到，**这个峰值并不代表某个特定频率的功率**，

255
0:15:27,6 --> 0:15:31,0
而是所有贡献到它的频率的功率。

##### 连续频谱可以观察功率密度

256
0:15:31,3 --> 0:15:34,77
因此，在某种程度上，**它代表了功率密度**。

257
0:15:34,77 --> 0:15:38,32
这个区域比这些区域密集得多，

258
0:15:38,32 --> 0:15:40,92
我们可以从峰值中看出这一点。

259
0:15:40,9 --> 0:15:45,9
我们可以通过**将其除以某个频率带宽来归一化这个图**，

##### 等效噪声带宽&窗口的功率谱

260
0:15:45,9 --> 0:15:54,7
特别是等效噪声带宽，它在某种程度上是贡献到功率谱中某个样本的频率的宽度。

261
0:15:54,72 --> 0:15:58,12
它是窗口本身的函数。

262
0:15:58,12 --> 0:16:0,37
有限长度的窗口必然

263
0:16:0,3 --> 0:16:3,9
会像我们看到的那样将附近频率的功率混合在一起。

264
0:16:3,9 --> 0:16:9,8
我们可以通过观察窗口本身的功率谱来了解这种混合是如何发生的。![image-20251108213654869](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108213654869.png)

265
0:16:9,88 --> 0:16:13,9
对于一个长度为128、

266
0:16:13,9 --> 0:16:16,45
采样率为1000赫兹的矩形窗口，这是它的功率谱。

267
0:16:16,45 --> 0:16:18,288
我已经将负频率移到

268
0:16:18,2 --> 0:16:23,0
左侧，以便更好地理解这条曲线的形状。

269
0:16:23,2 --> 0:16:27,43
注意**窗口在0赫兹处的最大功率为1。**

270
0:16:27,43 --> 0:16:29,32
因此，我们可以这样理解：

271
0:16:29,3 --> 0:16:35,2
这个窗口将使得被采样频率（0赫兹处）的功率原封不动的通过（窗口将这个0赫兹处的功率乘以1）

273
0:16:37,1 --> 0:16:41,6
因此，通过这种方式，我们可以准确地从**单个正弦波中获取功率**。

274
0:16:41,68 --> 0:16:44,2
然而，除了这个值之外，这个窗口

275
0:16:44,2 --> 0:16:47,2
还会**添加所有这些其他频率的功率**，这些频率的功率会被曲线所衰减。![image-20251108215549749](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108215549749.png)

277
0:16:51,4 --> 0:16:53,5
窗口越长，曲线越陡峭，这意味着较长的窗口![image-20251108215631397](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108215631397.png)

279
0:16:57,1 --> 0:17:2,7
比短窗口从附近频率中获得的贡献更少。

280
0:17:2,77 --> 0:17:5,108
好了，所以**频谱中的每个样本**
都是**所有这些附近频率衰减功率的总和**。

282
0:17:8,92 --> 0:17:11,8
因此，我们可能会认为我们感兴趣的带宽是这个尾部延伸的范围，![image-20251108215903129](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108215903129.png)

284
0:17:14,68 --> 0:17:17,68
因为所有这些频率都以某种方式包含在内。

285
0:17:17,6 --> 0:17:22,5
但正如我们所看到的，这些远处的频率贡献不大。

286
0:17:22,5 --> 0:17:26,6
我们真正只考虑影响最大的频率。

287
0:17:26,6 --> 0:17:33,4
我们找到这一点的方法是使用一个高度等于峰值的矩形来近似这条曲线，

288
0:17:33,46 --> 0:17:36,79
其面积等于总功率。![image-20251108220058756](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108220058756.png)

289
0:17:36,79 --> 0:17:39,58
因此，蓝色曲线下的面积

290
0:17:39,58 --> 0:17:42,4
等于红色矩形下的面积。

291
0:17:42,4 --> 0:17:46,7
**这个矩形的宽度就是等效噪声带宽。**![image-20251108220133628](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108220133628.png)

292
0:17:46,78 --> 0:17:49,9
在这个假设下，我们可以

293
0:17:49,0 --> 0:17:55,5
说**这是贡献到频谱中每个样本的频率范围**。

294
0:17:55,52 --> 0:17:58,4
因此，**为了得到功率谱密度**，

295
0:17:58,4 --> 0:18:1,73
我们**将功率谱除以等效噪声带宽**。![image-20251108220335853](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108220335853.png)

296
0:18:1,73 --> 0:18:3,5
我们知道功率谱

297
0:18:3,0 --> 0:18:6,9
是FFT的绝对值平方除以N的平方。

298
0:18:6,9 --> 0:18:11,9
这是任意窗口的等效噪声带宽的方程。

299
0:18:11,96 --> 0:18:14,69
我将在下面留下一个推导的链接。

300
0:18:14,69 --> 0:18:16,64
但我们理解这一点的方式是，

301
0:18:16,64 --> 0:18:18,5
我们将窗口中的每一项平方，

302
0:18:18,5 --> 0:18:21,95
将它们全部相加并乘以采样率，

303
0:18:21,9 --> 0:18:27,2
然后除以窗口项的总和的平方。

304
0:18:27,2 --> 0:18:32,5
因此，对于矩形窗口，N项中的每一项的值都是1。

305
0:18:32,57 --> 0:18:36,65
因此，这变成了fs乘以N除以N的平方，

306
0:18:36,6 --> 0:18:43,1
或者fs除以N。现在，当我们将功率谱除以这个值时，N被抵消了，

307
0:18:43,1 --> 0:18:48,3
我们剩下的是1除以fs乘以N乘以FFT的绝对值平方。

308
0:18:48,3 --> 0:18:54,4
这就是使用矩形窗口的功率谱密度的缩放比例。![image-20251108220345305](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108220345305.png)

309
0:18:54,49 --> 0:18:56,83
在本视频的最后一次，

310
0:18:56,83 --> 0:19:0,57
让我们回到MATLAB脚本并看看它的实际效果。

311
0:19:0,57 --> 0:19:2,14
你知道现在发生了什么，对吧？

312
0:19:2,14 --> 0:19:4,39
我们只是取FFT的绝对值，

313
0:19:4,3 --> 0:19:11,3
平方它，然后除以fs乘以N。瞧，功率谱密度。

314
0:19:11,35 --> 0:19:13,75
与其再次输入所有这些代码，

315
0:19:13,75 --> 0:19:17,59
我们可以使用periodogram函数来生成功率谱密度（PSD）。

316
0:19:17,59 --> 0:19:19,63
这个函数的好处是，

317
0:19:19,63 --> 0:19:22,72
你可以很容易地将输出更改为功率，

318
0:19:22,72 --> 0:19:27,37
或者更改窗口并快速查看结果。

319
0:19:27,37 --> 0:19:30,16
如果你想稍微玩一下这个脚本，

320
0:19:30,16 --> 0:19:32,29
我在下面留下了链接。

321
0:19:32,2 --> 0:19:36,7
但我希望这一切能澄清一些关于FFT和功率的困惑。

### broadband 信号，查看功率谱密度更有意义

322
0:19:36,7 --> 0:19:41,3
**要记住的是，如果你的信号由几个主要正弦波组成，**


**那么你可以查看功率谱以获取这些频率的功率。**


**然而，如果有宽带信号，**


**那么查看功率谱密度可能更有意义，**


**因为它返回的是每个频带的功率。**![image-20251108220715445](C:\Users\JC\AppData\Roaming\Typora\typora-user-images\image-20251108220715445.png)

327
0:19:54,8 --> 0:19:58,22
从数学上讲，你可以对单个正弦波进行功率谱密度分析，

328
0:19:58,22 --> 0:20:1,25
或者对宽带信号进行功率谱分析，

329
0:20:1,25 --> 0:20:2,81
你会得到一个图。

330
0:20:2,81 --> 0:20:6,23
但问题在于，当你试图将这些图

331
0:20:6,23 --> 0:20:9,8
与时域中的某些物理特性联系起来时，

332
0:20:9,8 --> 0:20:11,36
它们可能没有太大意义。

333
0:20:11,36 --> 0:20:13,22
这就是为什么你必须知道你想要实现的目标

334
0:20:13,2 --> 0:20:19,9
以及你正在查看的信号类型，以便选择正确的工具。

335
0:20:19,97 --> 0:20:22,88
好了，这就是本视频的内容。

336
0:20:22,88 --> 0:20:24,59
别忘了订阅这个频道，

337
0:20:24,59 --> 0:20:26,57
这样你就不会错过任何未来的视频。

