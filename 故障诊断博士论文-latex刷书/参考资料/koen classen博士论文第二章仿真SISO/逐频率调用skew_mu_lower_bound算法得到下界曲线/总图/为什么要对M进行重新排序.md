非常好的问题——为什么在代码里要做

```matlab
P = speye(nM); 
P = P(:, perm);
Mjw = P' * Mjw * P;
```

这样的**重新排序（reorder）操作**？

一句话总结：为了把用 `lftdata` 自动生成的 (M(s)) 的，按照 **不确定块出现顺序**自动生成的矩阵通道，转换成论文中假设的 “所有固定块在前，所有可变块在后” 的顺序。否则后续再按照论文进行就是对错误的对象进行操作了。

这个步骤看起来像只是“换个行列顺序”，但它在 Holland (2005) 的幂迭代算法中是**不可缺少的前置准备**。下面我结合论文内容详细解释这一点。

------

## 🔹一、背景：skew-μ 的结构化矩阵分块要求

论文 §3（Definition of the skew-μ problem）明确规定：

> “The uncertainty matrix Δ is block-diagonal, composed of two parts:
>  Δ = diag(D₍f₎, D₍v₎), where D₍f₎ is the *fixed-range* part and D₍v₎ is the *variable* part.”

而论文 §4.2 幂算法推导的首行（Eq. (17)–(18)）要求把矩阵 (M) 相应分成块：
$$
 M =
 \begin{bmatrix}
 M_{11} & M_{12} \
 M_{21} & M_{22}
 \end{bmatrix}, \quad
 g = M b =
 \begin{bmatrix}
 g_1 \ g_2
 \end{bmatrix},
$$
 其中：

* \(M_{11}\)、\(g_1\) 对应固定扰动块 \(D_f\)；
* \(M_{22}\)、\(g_2\) 对应变化扰动块 \(D_v\)。

算法后面所有关键公式——特别是 Eq. (15)、(16)
$$
v_* = \frac{|g_2|^2}{\sqrt{1-|g_1|^2}},\qquad
 v_c = \frac{|c_2|^2}{\sqrt{1-|c_1|^2}},
$$
 都是基于**这种块分区**计算的。

------

## 🔹二、现实中的 (M) 通道顺序是混乱的

在 MATLAB 中，用 `lftdata` 抽取 (M(s)) 后，得到的矩阵通道顺序往往是按照 **不确定块出现顺序**自动生成的，比如：

```
Δ = diag(delta1, Delta1)
```

如果 `delta1` 在模型里出现了 3 次、`Delta1` 出现了 1 次，
 `lftdata` 输出的 (M) 可能按 `[Δ1, Δ1, Δ1, Δ2]` 或其它内部顺序排列。
 这与论文假设的 “所有固定块在前，所有可变块在后” 顺序不一致。

------

## 🔹三、重新排序的目的

所以代码中这几行：

```matlab
P = speye(nM); 
P = P(:, perm);
Mjw = P' * Mjw * P;
```

构造了一个置换矩阵 (P)，把 (M(jω)) 的行和列**同时重排**，
 使得矩阵变为：
\[
 M' = P^T M P =
 \begin{bmatrix}
 M_{ff} & M_{fv} \
 M_{vf} & M_{vv}
 \end{bmatrix},
\]
 也就是：

| 区域       | 含义            |
| ---------- | --------------- |
| \(M_{ff}\) | 固定块间耦合    |
| (M_{fv})   | 固定→变化块耦合 |
| (M_{vf})   | 变化→固定块耦合 |
| (M_{vv})   | 变化块自身通道  |

这样才能与论文幂算法中“先算 g₁,g₂，再算 v”的公式一一对应。

------

## 🔹四、如果不重排会怎样？

如果直接把 `Mlin` 拿来用而不排序：

* (g = M b) 的前 n_f 元素不再对应固定块；
* (|g_1|) 和 (|g_2|) 就混杂了不同类型的不确定性；
* 计算出的 v 失去意义，幂迭代公式 (15)(16) 不再成立；
* 最终 μₛ 下界会错误（甚至发散）。

换句话说，排序就是确保**数学块结构和实际矩阵排列一致**。

------

## 🔹五、对应论文公式

这一步直接对应 Holland 论文 §4.2 中引入的分块结构：

> “Let g = M b = [g₁ᵗ g₂ᵗ]ᵗ where g₁ corresponds to the fixed uncertainty and g₂ to the varying uncertainty…”

没有这一步，后面的 Eq. (15)–(16) 及缩放矩阵
\[
 S=\mathrm{diag}(I_f,v I_v)
\]
 都无法正确应用。

------

## ✅ 小结

| 步骤                    | 目的                         | 对应论文                |
| ----------------------- | ---------------------------- | ----------------------- |
| 构造置换矩阵 P          | 区分固定块与变化块           | §3 定义 Δ = diag(Df,Dv) |
| 重新排序 (M' = P^T M P) | 获得 [M₁₁ M₁₂; M₂₁ M₂₂] 分块 | §4.2 Eq.(18)            |
| 后续 g₁,g₂ 提取         | 正确计算 v_* 、 v_#          | Eq.(15),(16)            |
| 缩放 S_L M S_R          | 在变化块子空间配平           | Eq.(23)                 |

因此，**重新排序的根本原因**是：

> 在实际模型生成的 (M) 中，通道顺序通常与理论块结构不一致；
>  为了让幂迭代能正确识别固定与变化不确定性子空间，必须把矩阵重新排序成论文所假设的标准块形式。